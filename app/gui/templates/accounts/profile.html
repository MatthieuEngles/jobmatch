{% extends "base.html" %}

{% block title %}Mon profil - JobMatch{% endblock %}

{% block extra_css %}
<style>
    :root {
        --primary: #4f46e5;
        --primary-dark: #4338ca;
        --secondary: #06b6d4;
        --dark: #0f172a;
        --light: #f8fafc;
        --gray: #64748b;
        --border: #e2e8f0;
    }

    .profile-layout {
        display: flex;
        gap: 32px;
        height: calc(100vh - 80px);
        padding: 20px 0;
        overflow: hidden;
    }

    /* Sidebar styles */
    .profile-sidebar {
        width: 280px;
        flex-shrink: 0;
        overflow-y: auto;
    }

    .profile-card {
        background: white;
        border-radius: 24px;
        border: 1px solid var(--border);
        overflow: hidden;
        position: sticky;
        top: 24px;
    }

    .profile-header {
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        padding: 32px;
        text-align: center;
        position: relative;
    }

    .photo-container {
        position: relative;
        width: 120px;
        height: 120px;
        margin: 0 auto 16px;
    }

    .profile-photo {
        width: 120px;
        height: 120px;
        border-radius: 50%;
        background: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 48px;
        color: var(--primary);
        border: 4px solid white;
        box-shadow: 0 8px 24px rgba(0,0,0,0.15);
        overflow: hidden;
    }

    .profile-photo img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .photo-upload-btn {
        position: absolute;
        bottom: 0;
        right: 0;
        width: 36px;
        height: 36px;
        background: white;
        border-radius: 50%;
        border: none;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
    }

    .photo-upload-btn:hover {
        transform: scale(1.1);
        background: var(--light);
    }

    .photo-upload-btn svg {
        width: 18px;
        height: 18px;
        color: var(--primary);
    }

    .profile-name {
        color: white;
        font-size: 1.25rem;
        font-weight: 700;
        margin-bottom: 4px;
    }

    .profile-email {
        color: rgba(255,255,255,0.8);
        font-size: 0.875rem;
    }

    /* Navigation menu */
    .profile-menu {
        padding: 16px 0;
    }

    .menu-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 14px 24px;
        color: var(--dark);
        text-decoration: none;
        transition: all 0.2s ease;
        border-left: 3px solid transparent;
        font-weight: 500;
    }

    .menu-item:hover {
        background: var(--light);
        color: var(--primary);
    }

    .menu-item.active {
        background: linear-gradient(90deg, rgba(79, 70, 229, 0.1), transparent);
        color: var(--primary);
        border-left-color: var(--primary);
    }

    .menu-item svg {
        width: 20px;
        height: 20px;
        flex-shrink: 0;
    }

    .menu-divider {
        height: 1px;
        background: var(--border);
        margin: 12px 24px;
    }

    .menu-item.danger {
        color: #dc2626;
    }

    .menu-item.danger:hover {
        background: #fef2f2;
    }

    /* Main content area */
    .profile-content {
        flex: 1;
        min-width: 0;
        overflow-y: auto;
    }

    .content-card {
        background: white;
        border-radius: 24px;
        border: 1px solid var(--border);
        padding: 40px;
    }

    .content-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 32px;
        padding-bottom: 24px;
        border-bottom: 1px solid var(--border);
    }

    .content-title {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--dark);
        margin: 0;
    }

    .content-subtitle {
        color: var(--gray);
        font-size: 0.95rem;
        margin-top: 4px;
    }

    /* Form styles */
    .form-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 24px;
    }

    .form-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }

    .form-group.full-width {
        grid-column: span 2;
    }

    .form-label {
        font-weight: 600;
        color: var(--dark);
        font-size: 0.875rem;
    }

    .form-control {
        padding: 12px 16px;
        border: 1px solid var(--border);
        border-radius: 12px;
        font-size: 1rem;
        transition: all 0.2s ease;
    }

    .form-control:focus {
        border-color: var(--primary);
        box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        outline: none;
    }

    .form-select {
        padding: 12px 16px;
        border: 1px solid var(--border);
        border-radius: 12px;
        font-size: 1rem;
        background-color: white;
    }

    .btn-save {
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        color: white;
        padding: 14px 32px;
        border-radius: 12px;
        border: none;
        font-weight: 600;
        font-size: 1rem;
        cursor: pointer;
        transition: all 0.2s ease;
        display: inline-flex;
        align-items: center;
        gap: 8px;
    }

    .btn-save:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 24px rgba(79, 70, 229, 0.3);
    }

    /* Empty state placeholder sections */
    .placeholder-section {
        text-align: center;
        padding: 60px 40px;
        background: var(--light);
        border-radius: 16px;
        border: 2px dashed var(--border);
    }

    .placeholder-icon {
        width: 64px;
        height: 64px;
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        border-radius: 16px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 20px;
    }

    .placeholder-icon svg {
        width: 32px;
        height: 32px;
        color: white;
    }

    .placeholder-title {
        font-size: 1.25rem;
        font-weight: 700;
        color: var(--dark);
        margin-bottom: 8px;
    }

    .placeholder-desc {
        color: var(--gray);
        margin-bottom: 24px;
    }

    .btn-add {
        background: white;
        color: var(--primary);
        padding: 12px 24px;
        border-radius: 12px;
        border: 1px solid var(--primary);
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s ease;
        display: inline-flex;
        align-items: center;
        gap: 8px;
    }

    .btn-add:hover {
        background: var(--primary);
        color: white;
    }

    /* Career path tabs */
    .tabs-container {
        margin-bottom: 24px;
    }

    .tabs-nav {
        display: flex;
        gap: 8px;
        border-bottom: 2px solid var(--border);
        padding-bottom: 0;
    }

    .tab-btn {
        padding: 12px 24px;
        background: none;
        border: none;
        font-weight: 600;
        font-size: 0.95rem;
        color: var(--gray);
        cursor: pointer;
        position: relative;
        transition: all 0.2s ease;
        border-bottom: 2px solid transparent;
        margin-bottom: -2px;
    }

    .tab-btn:hover {
        color: var(--primary);
    }

    .tab-btn.active {
        color: var(--primary);
        border-bottom-color: var(--primary);
    }

    .tab-btn svg {
        width: 18px;
        height: 18px;
        margin-right: 8px;
        vertical-align: middle;
    }

    .tab-content {
        display: none;
        padding-top: 24px;
    }

    .tab-content.active {
        display: block;
    }

    /* Extracted line items display */
    .extracted-items {
        display: flex;
        flex-direction: column;
        gap: 16px;
    }

    .extracted-item {
        background: var(--light);
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 16px 20px;
        transition: all 0.2s ease;
        position: relative;
    }

    .extracted-item:hover {
        border-color: var(--primary);
        box-shadow: 0 2px 8px rgba(79, 70, 229, 0.1);
    }

    .extracted-item.inactive {
        opacity: 0.5;
        background: #f8f8f8;
    }

    .extracted-item-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 8px;
    }

    .extracted-item-content {
        font-size: 0.95rem;
        color: var(--dark);
        line-height: 1.5;
        white-space: pre-wrap;
        flex: 1;
    }

    .extracted-item-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 12px;
        padding-top: 12px;
        border-top: 1px solid var(--border);
    }

    .extracted-item-source {
        font-size: 0.8rem;
        color: var(--gray);
        display: flex;
        align-items: center;
        gap: 4px;
    }

    .extracted-item-source svg {
        width: 14px;
        height: 14px;
    }

    .extracted-item-actions {
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .btn-edit-item {
        background: none;
        border: none;
        cursor: pointer;
        padding: 6px;
        color: var(--gray);
        border-radius: 6px;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .btn-edit-item:hover {
        background: var(--light);
        color: var(--primary);
    }

    .btn-edit-item svg {
        width: 16px;
        height: 16px;
    }

    /* Toggle switch for active/inactive */
    .toggle-switch {
        position: relative;
        width: 40px;
        height: 22px;
        cursor: pointer;
    }

    .toggle-switch input {
        opacity: 0;
        width: 0;
        height: 0;
    }

    .toggle-slider {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #dc2626;
        border-radius: 22px;
        transition: 0.3s;
    }

    .toggle-slider:before {
        position: absolute;
        content: "";
        height: 16px;
        width: 16px;
        left: 3px;
        bottom: 3px;
        background-color: white;
        border-radius: 50%;
        transition: 0.3s;
    }

    .toggle-switch input:checked + .toggle-slider {
        background-color: #22c55e;
    }

    .toggle-switch input:checked + .toggle-slider:before {
        transform: translateX(18px);
    }

    .btn-toggle-active {
        background: none;
        border: none;
        cursor: pointer;
        padding: 4px;
        color: var(--gray);
        transition: color 0.2s ease;
    }

    .btn-toggle-active:hover {
        color: var(--primary);
    }

    /* Skills grid layout */
    .skills-section {
        margin-bottom: 24px;
    }

    .skills-section-title {
        font-size: 0.9rem;
        font-weight: 600;
        color: var(--gray);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: 12px;
    }

    .skills-grid {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
    }

    .skill-tag {
        background: white;
        border: 1px solid var(--border);
        border-radius: 8px;
        padding: 8px 14px;
        font-size: 0.9rem;
        color: var(--dark);
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .skill-tag:hover {
        border-color: var(--primary);
        background: var(--light);
    }

    .skill-tag.hard {
        border-left: 3px solid var(--primary);
    }

    .skill-tag.soft {
        border-left: 3px solid #22c55e;
    }

    .skill-tag.inactive {
        opacity: 0.5;
        background: #f8f8f8;
    }

    .skill-tag-content {
        flex: 1;
    }

    .skill-tag-actions {
        display: flex;
        align-items: center;
        gap: 4px;
        margin-left: 4px;
    }

    .skill-tag .btn-edit-item {
        padding: 4px;
    }

    .skill-tag .btn-edit-item svg {
        width: 14px;
        height: 14px;
    }

    .skill-tag .toggle-switch {
        width: 32px;
        height: 18px;
    }

    .skill-tag .toggle-slider:before {
        height: 12px;
        width: 12px;
    }

    .skill-tag .toggle-switch input:checked + .toggle-slider:before {
        transform: translateX(14px);
    }

    .tab-content-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
    }

    .item-count {
        font-size: 0.85rem;
        color: var(--gray);
    }

    /* Documents section styles */
    .documents-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 24px;
    }

    .document-category {
        background: var(--light);
        border-radius: 16px;
        padding: 24px;
        border: 1px solid var(--border);
    }

    .document-category-header {
        display: flex;
        align-items: center;
        gap: 16px;
        margin-bottom: 20px;
    }

    .document-category-icon {
        width: 48px;
        height: 48px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
    }

    .document-category-icon.cv {
        background: linear-gradient(135deg, var(--primary), var(--secondary));
    }

    .document-category-icon.lm {
        background: linear-gradient(135deg, #f59e0b, #ef4444);
    }

    .document-category-icon svg {
        width: 24px;
        height: 24px;
        color: white;
    }

    .document-category-title {
        font-size: 1.1rem;
        font-weight: 700;
        color: var(--dark);
        margin: 0 0 4px 0;
    }

    .document-category-desc {
        font-size: 0.85rem;
        color: var(--gray);
        margin: 0;
    }

    .document-list {
        min-height: 80px;
        margin-bottom: 16px;
    }

    .document-empty {
        background: white;
        border-radius: 12px;
        padding: 24px;
        text-align: center;
        border: 2px dashed var(--border);
    }

    .document-empty p {
        color: var(--gray);
        margin: 0;
        font-size: 0.9rem;
    }

    .btn-add-document {
        width: 100%;
        background: white;
        color: var(--primary);
        padding: 12px 20px;
        border-radius: 12px;
        border: 1px solid var(--primary);
        font-weight: 600;
        font-size: 0.95rem;
        cursor: pointer;
        transition: all 0.2s ease;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
    }

    .btn-add-document:hover {
        background: var(--primary);
        color: white;
    }

    .btn-add-document:disabled {
        opacity: 0.6;
        cursor: not-allowed;
    }

    /* Upload modal overlay */
    .upload-modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1000;
        align-items: center;
        justify-content: center;
    }

    .upload-modal.active {
        display: flex;
    }

    .upload-modal-content {
        background: white;
        border-radius: 24px;
        padding: 32px;
        max-width: 480px;
        width: 90%;
        position: relative;
    }

    .upload-modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 24px;
    }

    .upload-modal-title {
        font-size: 1.25rem;
        font-weight: 700;
        color: var(--dark);
        margin: 0;
    }

    .upload-modal-close {
        background: none;
        border: none;
        cursor: pointer;
        padding: 8px;
        color: var(--gray);
        transition: color 0.2s;
    }

    .upload-modal-close:hover {
        color: var(--dark);
    }

    .upload-dropzone {
        border: 2px dashed var(--border);
        border-radius: 16px;
        padding: 40px;
        text-align: center;
        transition: all 0.2s ease;
        cursor: pointer;
    }

    .upload-dropzone:hover,
    .upload-dropzone.dragover {
        border-color: var(--primary);
        background: rgba(79, 70, 229, 0.05);
    }

    .upload-dropzone-icon {
        width: 64px;
        height: 64px;
        margin: 0 auto 16px;
        color: var(--primary);
    }

    .upload-dropzone-text {
        font-size: 1rem;
        color: var(--dark);
        margin-bottom: 8px;
    }

    .upload-dropzone-hint {
        font-size: 0.85rem;
        color: var(--gray);
    }

    .upload-progress {
        display: none;
        margin-top: 24px;
    }

    .upload-progress.active {
        display: block;
    }

    .upload-progress-bar {
        height: 8px;
        background: var(--border);
        border-radius: 4px;
        overflow: hidden;
    }

    .upload-progress-fill {
        height: 100%;
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        width: 0%;
        transition: width 0.3s ease;
    }

    .upload-progress-text {
        font-size: 0.85rem;
        color: var(--gray);
        margin-top: 8px;
        text-align: center;
    }

    .upload-result {
        display: none;
        margin-top: 24px;
        padding: 16px;
        border-radius: 12px;
        text-align: center;
    }

    .upload-result.success {
        display: block;
        background: #dcfce7;
        color: #166534;
    }

    .upload-result.error {
        display: block;
        background: #fef2f2;
        color: #dc2626;
    }

    /* Document item styles */
    .document-item {
        background: white;
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 12px 16px;
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 8px;
        transition: all 0.2s ease;
    }

    .document-item:hover {
        border-color: var(--primary);
    }

    .document-item-icon {
        width: 40px;
        height: 40px;
        background: var(--light);
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
    }

    .document-item-icon svg {
        width: 20px;
        height: 20px;
        color: var(--primary);
    }

    .document-item-info {
        flex: 1;
        min-width: 0;
    }

    .document-item-name {
        font-weight: 600;
        color: var(--dark);
        font-size: 0.9rem;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .document-item-meta {
        font-size: 0.8rem;
        color: var(--gray);
    }

    .document-item-status {
        padding: 4px 10px;
        border-radius: 20px;
        font-size: 0.75rem;
        font-weight: 600;
    }

    .document-item-status.completed {
        background: #dcfce7;
        color: #166534;
    }

    .document-item-status.processing {
        background: #fef3c7;
        color: #92400e;
    }

    .document-item-status.failed {
        background: #fef2f2;
        color: #dc2626;
    }

    .document-item-actions {
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .btn-delete-cv {
        background: none;
        border: none;
        cursor: pointer;
        padding: 6px;
        color: var(--gray);
        border-radius: 6px;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .btn-delete-cv:hover {
        background: #fef2f2;
        color: #dc2626;
    }

    .btn-delete-cv svg {
        width: 18px;
        height: 18px;
    }

    /* Delete confirmation modal */
    .confirm-modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1001;
        align-items: center;
        justify-content: center;
    }

    .confirm-modal.active {
        display: flex;
    }

    .confirm-modal-content {
        background: white;
        border-radius: 16px;
        padding: 24px;
        max-width: 400px;
        width: 90%;
        text-align: center;
    }

    .confirm-modal-icon {
        width: 48px;
        height: 48px;
        background: #fef2f2;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 16px;
        color: #dc2626;
    }

    .confirm-modal-icon svg {
        width: 24px;
        height: 24px;
    }

    .confirm-modal-title {
        font-size: 1.1rem;
        font-weight: 700;
        color: var(--dark);
        margin-bottom: 8px;
    }

    .confirm-modal-text {
        color: var(--gray);
        font-size: 0.9rem;
        margin-bottom: 20px;
    }

    .confirm-modal-actions {
        display: flex;
        gap: 12px;
        justify-content: center;
    }

    .btn-cancel {
        padding: 10px 20px;
        border: 1px solid var(--border);
        background: white;
        border-radius: 8px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s ease;
    }

    .btn-cancel:hover {
        background: var(--light);
    }

    .btn-confirm-delete {
        padding: 10px 20px;
        border: none;
        background: #dc2626;
        color: white;
        border-radius: 8px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s ease;
    }

    .btn-confirm-delete:hover {
        background: #b91c1c;
    }

    .btn-confirm-delete:disabled {
        opacity: 0.6;
        cursor: not-allowed;
    }

    @media (max-width: 768px) {
        .documents-grid {
            grid-template-columns: 1fr;
        }
    }

    /* Responsive breakpoints */
    @media (max-width: 992px) {
        .profile-layout {
            flex-direction: column;
        }
        .profile-sidebar {
            width: 100%;
        }
        .profile-card {
            position: static;
        }
        .form-grid {
            grid-template-columns: 1fr;
        }
        .form-group.full-width {
            grid-column: span 1;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="profile-layout">
    <!-- Profile sidebar with photo and navigation -->
    <aside class="profile-sidebar">
        <div class="profile-card">
            <div class="profile-header">
                <div class="photo-container">
                    <div class="profile-photo">
                        {% if user.photo %}
                            <img src="{{ user.photo.url }}" alt="Photo de profil">
                        {% else %}
                            {{ user.first_name|first|default:user.email|first|upper }}
                        {% endif %}
                    </div>
                    <button type="button" class="photo-upload-btn" title="Changer la photo">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" />
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" />
                        </svg>
                    </button>
                </div>
                <div class="profile-name">{{ user.first_name }} {{ user.last_name }}</div>
                <div class="profile-email">{{ user.email }}</div>
            </div>

            <nav class="profile-menu">
                <a href="#personal" class="menu-item active" data-section="personal">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                    </svg>
                    Donnees personnelles
                </a>
                <a href="#parcours" class="menu-item" data-section="parcours">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                    </svg>
                    Parcours professionnel
                </a>
                <a href="#pitch" class="menu-item" data-section="pitch">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z" />
                    </svg>
                    Mon pitch 30s/3min
                </a>
                <a href="#achievements" class="menu-item" data-section="achievements">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z" />
                    </svg>
                    Succes professionnels
                </a>
                <a href="#hobbies" class="menu-item" data-section="hobbies">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    Hobbies & personnel
                </a>
                <a href="#documents" class="menu-item" data-section="documents">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z" />
                    </svg>
                    Mes documents
                </a>

                <div class="menu-divider"></div>

                <a href="{% url 'accounts:settings' %}" class="menu-item">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                    </svg>
                    Gerer mon compte
                </a>
            </nav>
        </div>
    </aside>

    <!-- Main content area -->
    <main class="profile-content">
        <!-- Section: Personal data -->
        <section id="personal" class="content-section">
            <div class="content-card">
                <div class="content-header">
                    <div>
                        <h2 class="content-title">Donnees personnelles</h2>
                        <p class="content-subtitle">Gerez vos informations de profil et preferences</p>
                    </div>
                </div>

                <form method="post">
                    {% csrf_token %}
                    <div class="form-grid">
                        {% for field in form %}
                            <div class="form-group {% if field.name == 'email' %}full-width{% endif %}">
                                <label for="{{ field.id_for_label }}" class="form-label">{{ field.label }}</label>
                                {{ field }}
                                {% if field.errors %}
                                    <div class="text-danger small">
                                        {% for error in field.errors %}{{ error }}{% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                        {% endfor %}
                    </div>

                    <div class="mt-4">
                        <button type="submit" class="btn-save">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                            </svg>
                            Enregistrer
                        </button>
                    </div>
                </form>
            </div>
        </section>

        <!-- Section: Career path -->
        <section id="parcours" class="content-section" style="display: none;">
            <div class="content-card">
                <div class="content-header">
                    <div>
                        <h2 class="content-title">Parcours professionnel</h2>
                        <p class="content-subtitle">Gerez vos experiences, competences et formations</p>
                    </div>
                </div>

                <div class="tabs-container">
                    <div class="tabs-nav">
                        <button class="tab-btn active" data-tab="experiences">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                            </svg>
                            Experiences
                        </button>
                        <button class="tab-btn" data-tab="competences">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                            </svg>
                            Competences
                        </button>
                        <button class="tab-btn" data-tab="formations">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l9-5-9-5-9 5 9 5z" />
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z" />
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l9-5-9-5-9 5 9 5zm0 0l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14zm-4 6v-7.5l4-2.222" />
                            </svg>
                            Formations
                        </button>
                    </div>

                    <!-- Tab: Work experiences -->
                    <div id="tab-experiences" class="tab-content active">
                        {% if experiences %}
                        <div class="tab-content-header">
                            <span class="item-count">{{ experiences|length }} experience{{ experiences|length|pluralize }}</span>
                            <button class="btn-add">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                                </svg>
                                Ajouter
                            </button>
                        </div>
                        <div class="extracted-items">
                            {% for exp in experiences %}
                            <div class="extracted-item{% if not exp.is_active %} inactive{% endif %}" data-line-id="{{ exp.id }}">
                                <div class="extracted-item-content">{{ exp.content }}</div>
                                <div class="extracted-item-footer">
                                    <div class="extracted-item-source">
                                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                        </svg>
                                        {{ exp.source_cv.original_filename }}
                                    </div>
                                    <div class="extracted-item-actions">
                                        <button class="btn-edit-item" data-line-id="{{ exp.id }}" title="Modifier">
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                                            </svg>
                                        </button>
                                        <label class="toggle-switch" title="{% if exp.is_active %}Actif{% else %}Inactif{% endif %}">
                                            <input type="checkbox" class="toggle-active" data-line-id="{{ exp.id }}" {% if exp.is_active %}checked{% endif %}>
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                        {% else %}
                        <div class="placeholder-section">
                            <div class="placeholder-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                                </svg>
                            </div>
                            <h3 class="placeholder-title">Aucune experience ajoutee</h3>
                            <p class="placeholder-desc">Ajoutez vos experiences professionnelles ou importez un CV pour les extraire automatiquement</p>
                            <button class="btn-add">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                                </svg>
                                Ajouter une experience
                            </button>
                        </div>
                        {% endif %}
                    </div>

                    <!-- Tab: Skills -->
                    <div id="tab-competences" class="tab-content">
                        {% if skills_hard or skills_soft %}
                        <div class="tab-content-header">
                            <span class="item-count">{{ skills_hard|length|add:skills_soft|length }} competence{{ skills_hard|length|add:skills_soft|length|pluralize }}</span>
                            <button class="btn-add">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                                </svg>
                                Ajouter
                            </button>
                        </div>

                        {% if skills_hard %}
                        <div class="skills-section">
                            <h4 class="skills-section-title">Competences techniques</h4>
                            <div class="skills-grid">
                                {% for skill in skills_hard %}
                                <div class="skill-tag hard{% if not skill.is_active %} inactive{% endif %}" data-line-id="{{ skill.id }}">
                                    <span class="skill-tag-content">{{ skill.content }}</span>
                                    <div class="skill-tag-actions">
                                        <button class="btn-edit-item" data-line-id="{{ skill.id }}" title="Modifier">
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                                            </svg>
                                        </button>
                                        <label class="toggle-switch" title="{% if skill.is_active %}Actif{% else %}Inactif{% endif %}">
                                            <input type="checkbox" class="toggle-active" data-line-id="{{ skill.id }}" {% if skill.is_active %}checked{% endif %}>
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                        {% endif %}

                        {% if skills_soft %}
                        <div class="skills-section">
                            <h4 class="skills-section-title">Soft skills</h4>
                            <div class="skills-grid">
                                {% for skill in skills_soft %}
                                <div class="skill-tag soft{% if not skill.is_active %} inactive{% endif %}" data-line-id="{{ skill.id }}">
                                    <span class="skill-tag-content">{{ skill.content }}</span>
                                    <div class="skill-tag-actions">
                                        <button class="btn-edit-item" data-line-id="{{ skill.id }}" title="Modifier">
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                                            </svg>
                                        </button>
                                        <label class="toggle-switch" title="{% if skill.is_active %}Actif{% else %}Inactif{% endif %}">
                                            <input type="checkbox" class="toggle-active" data-line-id="{{ skill.id }}" {% if skill.is_active %}checked{% endif %}>
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                        {% endif %}

                        {% else %}
                        <div class="placeholder-section">
                            <div class="placeholder-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                                </svg>
                            </div>
                            <h3 class="placeholder-title">Aucune competence ajoutee</h3>
                            <p class="placeholder-desc">Ajoutez vos competences techniques et soft skills</p>
                            <button class="btn-add">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                                </svg>
                                Ajouter une competence
                            </button>
                        </div>
                        {% endif %}
                    </div>

                    <!-- Tab: Education -->
                    <div id="tab-formations" class="tab-content">
                        {% if educations or certifications %}
                        <div class="tab-content-header">
                            <span class="item-count">{{ educations|length|add:certifications|length }} formation{{ educations|length|add:certifications|length|pluralize }}</span>
                            <button class="btn-add">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                                </svg>
                                Ajouter
                            </button>
                        </div>

                        {% if educations %}
                        <div class="skills-section">
                            <h4 class="skills-section-title">Diplomes</h4>
                            <div class="extracted-items">
                                {% for edu in educations %}
                                <div class="extracted-item{% if not edu.is_active %} inactive{% endif %}" data-line-id="{{ edu.id }}">
                                    <div class="extracted-item-content">{{ edu.content }}</div>
                                    <div class="extracted-item-footer">
                                        <div class="extracted-item-source">
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                            </svg>
                                            {{ edu.source_cv.original_filename }}
                                        </div>
                                        <div class="extracted-item-actions">
                                            <button class="btn-edit-item" data-line-id="{{ edu.id }}" title="Modifier">
                                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                                                </svg>
                                            </button>
                                            <label class="toggle-switch" title="{% if edu.is_active %}Actif{% else %}Inactif{% endif %}">
                                                <input type="checkbox" class="toggle-active" data-line-id="{{ edu.id }}" {% if edu.is_active %}checked{% endif %}>
                                                <span class="toggle-slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                        {% endif %}

                        {% if certifications %}
                        <div class="skills-section">
                            <h4 class="skills-section-title">Certifications</h4>
                            <div class="extracted-items">
                                {% for cert in certifications %}
                                <div class="extracted-item{% if not cert.is_active %} inactive{% endif %}" data-line-id="{{ cert.id }}">
                                    <div class="extracted-item-content">{{ cert.content }}</div>
                                    <div class="extracted-item-footer">
                                        <div class="extracted-item-source">
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                            </svg>
                                            {{ cert.source_cv.original_filename }}
                                        </div>
                                        <div class="extracted-item-actions">
                                            <button class="btn-edit-item" data-line-id="{{ cert.id }}" title="Modifier">
                                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                                                </svg>
                                            </button>
                                            <label class="toggle-switch" title="{% if cert.is_active %}Actif{% else %}Inactif{% endif %}">
                                                <input type="checkbox" class="toggle-active" data-line-id="{{ cert.id }}" {% if cert.is_active %}checked{% endif %}>
                                                <span class="toggle-slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                        {% endif %}

                        {% else %}
                        <div class="placeholder-section">
                            <div class="placeholder-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l9-5-9-5-9 5 9 5z" />
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z" />
                                </svg>
                            </div>
                            <h3 class="placeholder-title">Aucune formation ajoutee</h3>
                            <p class="placeholder-desc">Ajoutez vos diplomes et certifications</p>
                            <button class="btn-add">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                                </svg>
                                Ajouter une formation
                            </button>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </section>

        <!-- Section: Elevator pitch -->
        <section id="pitch" class="content-section" style="display: none;">
            <div class="content-card">
                <div class="content-header">
                    <div>
                        <h2 class="content-title">Mon pitch</h2>
                        <p class="content-subtitle">Preparez votre presentation en 30 secondes et 3 minutes</p>
                    </div>
                </div>

                <div class="placeholder-section">
                    <div class="placeholder-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z" />
                        </svg>
                    </div>
                    <h3 class="placeholder-title">Pitch non configure</h3>
                    <p class="placeholder-desc">Redigez votre pitch pour etre pret lors de vos entretiens</p>
                    <button class="btn-add">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                        </svg>
                        Rediger mon pitch
                    </button>
                </div>
            </div>
        </section>

        <!-- Section: Professional achievements -->
        <section id="achievements" class="content-section" style="display: none;">
            <div class="content-card">
                <div class="content-header">
                    <div>
                        <h2 class="content-title">Succes professionnels</h2>
                        <p class="content-subtitle">Listez vos accomplissements et reussites professionnelles</p>
                    </div>
                </div>

                <div class="placeholder-section">
                    <div class="placeholder-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z" />
                        </svg>
                    </div>
                    <h3 class="placeholder-title">Aucun succes ajoute</h3>
                    <p class="placeholder-desc">Ajoutez vos realisations pour enrichir votre profil</p>
                    <button class="btn-add">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                        </svg>
                        Ajouter un succes
                    </button>
                </div>
            </div>
        </section>

        <!-- Section: Hobbies and personal interests -->
        <section id="hobbies" class="content-section" style="display: none;">
            <div class="content-card">
                <div class="content-header">
                    <div>
                        <h2 class="content-title">Hobbies & personnel</h2>
                        <p class="content-subtitle">Partagez vos centres d'interet et accomplissements personnels</p>
                    </div>
                </div>

                <div class="placeholder-section">
                    <div class="placeholder-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                    </div>
                    <h3 class="placeholder-title">Aucun hobby ajoute</h3>
                    <p class="placeholder-desc">Ajoutez vos passions et activites personnelles</p>
                    <button class="btn-add">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                        </svg>
                        Ajouter un hobby
                    </button>
                </div>
            </div>
        </section>

        <!-- Section: My documents (CV and cover letters) -->
        <section id="documents" class="content-section" style="display: none;">
            <div class="content-card">
                <div class="content-header">
                    <div>
                        <h2 class="content-title">Mes documents</h2>
                        <p class="content-subtitle">Importez et gerez vos CV et lettres de motivation</p>
                    </div>
                </div>

                <div class="documents-grid">
                    <!-- CV upload section -->
                    <div class="document-category">
                        <div class="document-category-header">
                            <div class="document-category-icon cv">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                </svg>
                            </div>
                            <div>
                                <h3 class="document-category-title">Curriculum Vitae</h3>
                                <p class="document-category-desc">Importez vos CV pour le matching automatique</p>
                            </div>
                        </div>
                        <div class="document-list" id="cv-list">
                            {% for cv in user_cvs %}
                            <div class="document-item" data-cv-id="{{ cv.id }}" data-task-id="{{ cv.task_id|default:'' }}" data-status="{{ cv.extraction_status }}">
                                <div class="document-item-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                    </svg>
                                </div>
                                <div class="document-item-info">
                                    <div class="document-item-name">{{ cv.original_filename }}</div>
                                    <div class="document-item-meta">{{ cv.uploaded_at|date:"d/m/Y H:i" }}</div>
                                </div>
                                <div class="document-item-actions">
                                    <span class="document-item-status {{ cv.extraction_status }}">
                                        {% if cv.extraction_status == 'completed' %}Extrait
                                        {% elif cv.extraction_status == 'processing' %}En cours...
                                        {% elif cv.extraction_status == 'failed' %}Echec
                                        {% else %}En attente{% endif %}
                                    </span>
                                    <button class="btn-delete-cv" data-cv-id="{{ cv.id }}" data-cv-name="{{ cv.original_filename }}" title="Supprimer">
                                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            {% empty %}
                            <div class="document-empty">
                                <p>Aucun CV importe</p>
                            </div>
                            {% endfor %}
                        </div>
                        <button class="btn-add-document" id="btn-upload-cv">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                            </svg>
                            Importer un CV
                        </button>
                    </div>

                    <!-- Cover letters section -->
                    <div class="document-category">
                        <div class="document-category-header">
                            <div class="document-category-icon lm">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                                </svg>
                            </div>
                            <div>
                                <h3 class="document-category-title">Lettres de motivation</h3>
                                <p class="document-category-desc">Gerez vos modeles de lettres</p>
                            </div>
                        </div>
                        <div class="document-list">
                            <div class="document-empty">
                                <p>Aucune lettre importee</p>
                            </div>
                        </div>
                        <button class="btn-add-document">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                            </svg>
                            Importer une lettre
                        </button>
                    </div>
                </div>
            </div>
        </section>
    </main>
</div>

<!-- CV Upload Modal -->
<div class="upload-modal" id="cv-upload-modal">
    <div class="upload-modal-content">
        <div class="upload-modal-header">
            <h3 class="upload-modal-title">Importer un CV</h3>
            <button class="upload-modal-close" id="close-upload-modal">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
        </div>

        <form id="cv-upload-form" enctype="multipart/form-data">
            {% csrf_token %}
            <input type="file" id="cv-file-input" name="file" accept=".pdf,.docx" style="display: none;">

            <div class="upload-dropzone" id="upload-dropzone">
                <svg class="upload-dropzone-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                </svg>
                <p class="upload-dropzone-text">Glissez votre CV ici ou cliquez pour parcourir</p>
                <p class="upload-dropzone-hint">Formats acceptes : PDF, DOCX (max 10 Mo)</p>
            </div>

            <div class="upload-progress" id="upload-progress">
                <div class="upload-progress-bar">
                    <div class="upload-progress-fill" id="upload-progress-fill"></div>
                </div>
                <p class="upload-progress-text" id="upload-progress-text">Extraction en cours...</p>
            </div>

            <div class="upload-result" id="upload-result"></div>
        </form>
    </div>
</div>

<!-- CV Delete Confirmation Modal -->
<div class="confirm-modal" id="cv-delete-modal">
    <div class="confirm-modal-content">
        <div class="confirm-modal-icon">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
            </svg>
        </div>
        <h3 class="confirm-modal-title">Supprimer ce CV ?</h3>
        <p class="confirm-modal-text" id="delete-cv-name">Cette action supprimera egalement toutes les donnees extraites de ce CV.</p>
        <div class="confirm-modal-actions">
            <button class="btn-cancel" id="cancel-delete-cv">Annuler</button>
            <button class="btn-confirm-delete" id="confirm-delete-cv">Supprimer</button>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Sidebar menu navigation
    const menuItems = document.querySelectorAll('.menu-item[data-section]');
    const sections = document.querySelectorAll('.content-section');

    // Function to show a specific section
    function showSection(sectionId) {
        // Update active menu item
        menuItems.forEach(m => m.classList.remove('active'));
        const activeItem = document.querySelector(`.menu-item[data-section="${sectionId}"]`);
        if (activeItem) activeItem.classList.add('active');

        // Display selected section
        sections.forEach(s => s.style.display = 'none');
        const section = document.getElementById(sectionId);
        if (section) section.style.display = 'block';

        // Update URL hash without scrolling
        history.replaceState(null, null, '#' + sectionId);
    }

    // Handle menu item clicks
    menuItems.forEach(item => {
        item.addEventListener('click', function(e) {
            e.preventDefault();
            const sectionId = this.getAttribute('data-section');
            showSection(sectionId);
        });
    });

    // On page load, check for hash in URL and show that section
    const hash = window.location.hash.substring(1);
    if (hash && document.getElementById(hash)) {
        showSection(hash);
    }

    // Tab navigation for career path section
    const tabBtns = document.querySelectorAll('.tab-btn');
    const tabContents = document.querySelectorAll('.tab-content');

    tabBtns.forEach(btn => {
        btn.addEventListener('click', function() {
            const tabId = this.getAttribute('data-tab');

            // Update active tab button
            tabBtns.forEach(b => b.classList.remove('active'));
            this.classList.add('active');

            // Display selected tab content
            tabContents.forEach(c => c.classList.remove('active'));
            document.getElementById('tab-' + tabId).classList.add('active');
        });
    });

    // CV Upload functionality
    const uploadModal = document.getElementById('cv-upload-modal');
    const uploadBtn = document.getElementById('btn-upload-cv');
    const closeBtn = document.getElementById('close-upload-modal');
    const dropzone = document.getElementById('upload-dropzone');
    const fileInput = document.getElementById('cv-file-input');
    const uploadForm = document.getElementById('cv-upload-form');
    const progressDiv = document.getElementById('upload-progress');
    const progressFill = document.getElementById('upload-progress-fill');
    const progressText = document.getElementById('upload-progress-text');
    const resultDiv = document.getElementById('upload-result');

    // Polling configuration
    const POLL_INTERVAL = 2000;  // 2 seconds
    const MAX_POLL_ATTEMPTS = 120;  // 4 minutes max
    let pollCount = 0;
    let pollTimer = null;

    // Open modal
    uploadBtn.addEventListener('click', function() {
        uploadModal.classList.add('active');
        resetUploadState();
    });

    // Close modal
    closeBtn.addEventListener('click', function() {
        uploadModal.classList.remove('active');
        if (pollTimer) {
            clearTimeout(pollTimer);
            pollTimer = null;
        }
    });

    // Close on outside click
    uploadModal.addEventListener('click', function(e) {
        if (e.target === uploadModal) {
            uploadModal.classList.remove('active');
            if (pollTimer) {
                clearTimeout(pollTimer);
                pollTimer = null;
            }
        }
    });

    // Click on dropzone opens file picker
    dropzone.addEventListener('click', function() {
        fileInput.click();
    });

    // Drag and drop handlers
    dropzone.addEventListener('dragover', function(e) {
        e.preventDefault();
        dropzone.classList.add('dragover');
    });

    dropzone.addEventListener('dragleave', function() {
        dropzone.classList.remove('dragover');
    });

    dropzone.addEventListener('drop', function(e) {
        e.preventDefault();
        dropzone.classList.remove('dragover');
        const files = e.dataTransfer.files;
        if (files.length > 0) {
            handleFileUpload(files[0]);
        }
    });

    // File input change
    fileInput.addEventListener('change', function() {
        if (this.files.length > 0) {
            handleFileUpload(this.files[0]);
        }
    });

    function resetUploadState() {
        progressDiv.classList.remove('active');
        resultDiv.className = 'upload-result';
        resultDiv.textContent = '';
        progressFill.style.width = '0%';
        fileInput.value = '';
        dropzone.style.display = 'block';
        pollCount = 0;
        if (pollTimer) {
            clearTimeout(pollTimer);
            pollTimer = null;
        }
    }

    function handleFileUpload(file) {
        // Validate file type
        const allowedTypes = ['application/pdf', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'];
        if (!allowedTypes.includes(file.type)) {
            showResult('Format non supporte. Utilisez PDF ou DOCX.', 'error');
            return;
        }

        // Validate file size (10 MB)
        if (file.size > 10 * 1024 * 1024) {
            showResult('Fichier trop volumineux (max 10 Mo).', 'error');
            return;
        }

        // Show progress
        dropzone.style.display = 'none';
        progressDiv.classList.add('active');
        progressText.textContent = 'Envoi du fichier...';
        progressFill.style.width = '10%';

        // Create form data
        const formData = new FormData();
        formData.append('file', file);
        formData.append('csrfmiddlewaretoken', document.querySelector('[name=csrfmiddlewaretoken]').value);

        // Send request
        fetch('{% url "accounts:cv_upload" %}', {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            if (data.success && data.task_id) {
                // Start polling for status
                progressFill.style.width = '30%';
                progressText.textContent = 'Analyse du CV en cours...';
                pollForStatus(data.task_id);
            } else {
                showResult(data.error || 'Erreur lors de la soumission.', 'error');
            }
        })
        .catch(error => {
            console.error('Upload error:', error);
            showResult('Erreur de connexion au serveur.', 'error');
        });
    }

    function pollForStatus(taskId) {
        pollCount++;

        if (pollCount > MAX_POLL_ATTEMPTS) {
            showResult('L\'extraction prend trop de temps. Veuillez recharger la page.', 'error');
            return;
        }

        // Update progress animation
        const progress = Math.min(30 + (pollCount * 2), 90);
        progressFill.style.width = progress + '%';

        if (pollCount % 5 === 0) {
            const messages = [
                'Analyse du CV en cours...',
                'Extraction des experiences...',
                'Identification des competences...',
                'Traitement des formations...',
                'Finalisation...'
            ];
            const msgIndex = Math.min(Math.floor(pollCount / 5), messages.length - 1);
            progressText.textContent = messages[msgIndex];
        }

        fetch('/accounts/cv/status/' + taskId + '/')
        .then(response => response.json())
        .then(data => {
            if (data.status === 'pending' || data.status === 'processing') {
                // Continue polling
                pollTimer = setTimeout(() => pollForStatus(taskId), POLL_INTERVAL);
            } else if (data.status === 'completed') {
                progressFill.style.width = '100%';
                progressText.textContent = 'Extraction terminee !';
                setTimeout(() => {
                    showResult(data.message || 'CV importe avec succes !', 'success');
                    // Reload page to show updated data, staying on documents section
                    setTimeout(() => {
                        window.location.hash = 'documents';
                        window.location.reload();
                    }, 1500);
                }, 500);
            } else if (data.status === 'failed') {
                showResult(data.error || 'L\'extraction a echoue.', 'error');
            } else {
                // Unknown status or error
                showResult(data.error || 'Erreur inattendue.', 'error');
            }
        })
        .catch(error => {
            console.error('Status check error:', error);
            // Retry on network error
            pollTimer = setTimeout(() => pollForStatus(taskId), POLL_INTERVAL);
        });
    }

    function showResult(message, type) {
        progressDiv.classList.remove('active');
        resultDiv.className = 'upload-result ' + type;
        resultDiv.textContent = message;
    }

    // Resume polling for CVs that are still processing
    function resumeProcessingCVs() {
        document.querySelectorAll('.document-item[data-status="processing"]').forEach(item => {
            const taskId = item.getAttribute('data-task-id');
            if (taskId) {
                console.log('Resuming polling for task:', taskId);
                pollExistingCV(taskId, item);
            }
        });
    }

    // Poll for an existing CV (without modal, updates DOM directly)
    function pollExistingCV(taskId, itemElement) {
        fetch('/accounts/cv/status/' + taskId + '/')
        .then(response => response.json())
        .then(data => {
            const statusSpan = itemElement.querySelector('.document-item-status');
            if (data.status === 'pending' || data.status === 'processing') {
                // Continue polling
                setTimeout(() => pollExistingCV(taskId, itemElement), POLL_INTERVAL);
            } else if (data.status === 'completed') {
                // Update status in DOM
                if (statusSpan) {
                    statusSpan.textContent = 'Extrait';
                    statusSpan.className = 'document-item-status completed';
                }
                itemElement.setAttribute('data-status', 'completed');
                // Reload page to show extracted lines
                setTimeout(() => {
                    window.location.hash = 'documents';
                    window.location.reload();
                }, 1000);
            } else if (data.status === 'failed') {
                if (statusSpan) {
                    statusSpan.textContent = 'Echec';
                    statusSpan.className = 'document-item-status failed';
                }
                itemElement.setAttribute('data-status', 'failed');
            }
        })
        .catch(error => {
            console.error('Status check error:', error);
            // Retry on network error
            setTimeout(() => pollExistingCV(taskId, itemElement), POLL_INTERVAL);
        });
    }

    // Start resuming processing CVs on page load
    resumeProcessingCVs();

    // CV Delete functionality
    const deleteModal = document.getElementById('cv-delete-modal');
    const deleteNameText = document.getElementById('delete-cv-name');
    const cancelDeleteBtn = document.getElementById('cancel-delete-cv');
    const confirmDeleteBtn = document.getElementById('confirm-delete-cv');
    let cvToDelete = null;

    // Add click handlers to all delete buttons
    document.querySelectorAll('.btn-delete-cv').forEach(btn => {
        btn.addEventListener('click', function(e) {
            e.stopPropagation();
            cvToDelete = {
                id: this.getAttribute('data-cv-id'),
                name: this.getAttribute('data-cv-name')
            };
            deleteNameText.innerHTML = `<strong>${cvToDelete.name}</strong><br>Cette action supprimera egalement toutes les donnees extraites de ce CV.`;
            deleteModal.classList.add('active');
        });
    });

    // Cancel delete
    cancelDeleteBtn.addEventListener('click', function() {
        deleteModal.classList.remove('active');
        cvToDelete = null;
    });

    // Close on outside click
    deleteModal.addEventListener('click', function(e) {
        if (e.target === deleteModal) {
            deleteModal.classList.remove('active');
            cvToDelete = null;
        }
    });

    // Confirm delete
    confirmDeleteBtn.addEventListener('click', function() {
        if (!cvToDelete) return;

        confirmDeleteBtn.disabled = true;
        confirmDeleteBtn.textContent = 'Suppression...';

        fetch('/accounts/cv/delete/' + cvToDelete.id + '/', {
            method: 'DELETE',
            headers: {
                'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // Remove the CV item from the DOM
                const cvItem = document.querySelector(`.document-item[data-cv-id="${cvToDelete.id}"]`);
                if (cvItem) {
                    cvItem.remove();
                }
                // Check if list is empty and show empty message
                const cvList = document.getElementById('cv-list');
                if (cvList && cvList.querySelectorAll('.document-item').length === 0) {
                    cvList.innerHTML = '<div class="document-empty"><p>Aucun CV importe</p></div>';
                }
                deleteModal.classList.remove('active');
                // Reload page to update extracted lines display, staying on documents section
                window.location.hash = 'documents';
                window.location.reload();
            } else {
                alert(data.error || 'Erreur lors de la suppression.');
                confirmDeleteBtn.disabled = false;
                confirmDeleteBtn.textContent = 'Supprimer';
            }
        })
        .catch(error => {
            console.error('Delete error:', error);
            alert('Erreur de connexion au serveur.');
            confirmDeleteBtn.disabled = false;
            confirmDeleteBtn.textContent = 'Supprimer';
        });
    });

    // ExtractedLine toggle active functionality
    document.querySelectorAll('.toggle-active').forEach(toggle => {
        toggle.addEventListener('change', function() {
            const lineId = this.getAttribute('data-line-id');
            const isChecked = this.checked;
            const itemElement = this.closest('.extracted-item, .skill-tag');

            fetch('/accounts/line/toggle/' + lineId + '/', {
                method: 'POST',
                headers: {
                    'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value,
                    'Content-Type': 'application/json'
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Update visual state
                    if (data.is_active) {
                        itemElement.classList.remove('inactive');
                    } else {
                        itemElement.classList.add('inactive');
                    }
                    // Update toggle title
                    this.closest('.toggle-switch').title = data.is_active ? 'Actif' : 'Inactif';
                } else {
                    // Revert toggle on error
                    this.checked = !isChecked;
                    alert(data.error || 'Erreur lors de la modification.');
                }
            })
            .catch(error => {
                console.error('Toggle error:', error);
                // Revert toggle on error
                this.checked = !isChecked;
                alert('Erreur de connexion au serveur.');
            });
        });
    });

    // Edit button click handler (placeholder for future implementation)
    document.querySelectorAll('.btn-edit-item').forEach(btn => {
        btn.addEventListener('click', function(e) {
            e.preventDefault();
            const lineId = this.getAttribute('data-line-id');
            // TODO: Open edit modal or inline edit
            console.log('Edit line:', lineId);
            alert('Fonctionnalit d\'dition  venir');
        });
    });
});
</script>
{% endblock %}
